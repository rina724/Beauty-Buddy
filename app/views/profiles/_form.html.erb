<%= turbo_frame_tag "_form" do %>
  <div class="text-lg outline-dashed outline-beige rounded p-4">
  <%= form_with(url: profile_path(@current_user_profile), method: :patch,local: true, class: 'space-y-4') do |form| %>
      <%= form.label :caution, "表示したい成分を選択してください:" %><br>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <% @caution_ingredients.each do |ingredient| %>
        <div class="flex items-center space-x-2">
          <%= check_box_tag "ingredient_ids[]",
              ingredient.id,
              @current_user_profile.ingredient_selected?(ingredient),
              { 
                class: "checkbox",
                id: "ingredient_#{ingredient.id}"
              }
          %>
          <%= label_tag "ingredient_#{ingredient.id}", class: "cursor-pointer" do %>
            <%= ingredient.name %>
            <span class="text-sm text-gray-500">
              （<%= @ingredient_counts[ingredient] %>回検出）
            </span>
          <% end %>
        </div>
      <% end %>

      <div class="mt-6">
        <%= form.submit "設定を保存", class: "btn btn-primary" %>
      </div>
    <% end %>
  </div>
<% end %>